{% extends 'base.html' %}

{% block title %}{{ assessment.name }} - MindCare{% endblock %}

{% block content %}
<div class="gradient-bg py-8">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="bg-white rounded-xl shadow-sm p-8 card-hover">
        <div class="flex items-start justify-between">
            <div class="flex items-start">
                <div class="w-20 h-20 bg-purple-100 rounded-full flex items-center justify-center mr-6">
                    <i class="fas fa-brain text-purple-600 text-3xl"></i>
                </div>
                <div>
                    <h1 class="text-4xl font-bold text-gray-800 mb-2">{{ assessment.name }}</h1>
                    <p class="text-gray-600 mb-4">{{ assessment.description }}</p>
                    
                    <!-- Assessment Stats -->
                    <div class="flex items-center space-x-6 text-sm text-gray-500">
                        <span class="flex items-center">
                            <i class="fas fa-clock mr-2"></i>
                            Estimated time: {{ assessment.estimated_time }} minutes
                        </span>
                        <span class="flex items-center">
                            <i class="fas fa-question-circle mr-2"></i>
                            {{ question_count }} questions
                        </span>
                        <span class="flex items-center">
                            <i class="fas fa-chart-bar mr-2"></i>
                            Max score: {{ assessment.max_score }}
                        </span>
                    </div>
                </div>
            </div>
            
            <!-- Take Assessment Button -->
            <a href="{% url 'assessments:take' assessment.short_name %}" 
               class="bg-purple-500 hover:bg-purple-600 text-white px-8 py-4 rounded-lg font-semibold text-lg transition card-hover inline-flex items-center">
                <i class="fas fa-play mr-2"></i>
                Start Assessment
            </a>
        </div>
    </div>
</div>

<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        <!-- Main Content -->
        <div class="lg:col-span-2 space-y-8">
            <!-- Instructions -->
            <div class="bg-white rounded-xl shadow-sm p-6 card-hover">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">
                    <i class="fas fa-info-circle text-purple-500 mr-2"></i>
                    Instructions
                </h2>
                <p class="text-gray-700 leading-relaxed">{{ assessment.instruction }}</p>
            </div>

            <!-- What to Expect -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h2 class="text-xl font-semibold text-gray-900 mb-4">
                    <i class="fas fa-lightbulb text-yellow-500 mr-2"></i>
                    What to Expect
                </h2>
                <div class="space-y-4">
                    <div class="flex items-start">
                        <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3 mt-1">
                            <span class="text-blue-600 font-semibold text-sm">1</span>
                        </div>
                        <div>
                            <h3 class="font-semibold text-gray-900">Answer Questions</h3>
                            <p class="text-gray-600">Respond honestly to {{ question_count }} questions about your recent experiences.</p>
                        </div>
                    </div>
                    <div class="flex items-start">
                        <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3 mt-1">
                            <span class="text-blue-600 font-semibold text-sm">2</span>
                        </div>
                        <div>
                            <h3 class="font-semibold text-gray-900">Get Your Score</h3>
                            <p class="text-gray-600">Receive an immediate score with severity level assessment.</p>
                        </div>
                    </div>
                    <div class="flex items-start">
                        <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3 mt-1">
                            <span class="text-blue-600 font-semibold text-sm">3</span>
                        </div>
                        <div>
                            <h3 class="font-semibold text-gray-900">Personalized Guidance</h3>
                            <p class="text-gray-600">Get recommendations and resources based on your results.</p>
                        </div>
                    </div>
                </div>
            </div>

            {% if recent_assessments %}
            <!-- Previous Results -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h2 class="text-xl font-semibold text-gray-900 mb-4">
                    <i class="fas fa-history text-purple-600 mr-2"></i>
                    Your Recent Results
                </h2>
                <div class="space-y-4">
                    {% for prev_assessment in recent_assessments %}
                    <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                        <div>
                            <p class="font-medium text-gray-900">{{ prev_assessment.completed_at|date:"M d, Y" }}</p>
                            <p class="text-sm text-gray-600">Score: {{ prev_assessment.total_score }}/{{ assessment.max_score }}</p>
                        </div>
                        <div class="flex items-center">
                            <span class="px-3 py-1 rounded-full text-xs font-medium
                                {% if prev_assessment.severity_level == 'Minimal' %}bg-green-100 text-green-800
                                {% elif prev_assessment.severity_level == 'Mild' %}bg-yellow-100 text-yellow-800
                                {% elif prev_assessment.severity_level == 'Moderate' %}bg-orange-100 text-orange-800
                                {% else %}bg-red-100 text-red-800{% endif %}">
                                {{ prev_assessment.severity_level }}
                            </span>
                            <a href="{% url 'assessments:result' prev_assessment.id %}" class="ml-3 text-blue-600 hover:text-blue-800 text-sm">View Details</a>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}
        </div>

        <!-- Sidebar -->
        <div class="space-y-6">
            <!-- Privacy & Security -->
            <div class="bg-white rounded-xl shadow-sm p-6 card-hover">
                <h3 class="text-lg font-semibold text-gray-800 mb-4">
                    <i class="fas fa-shield-alt text-green-500 mr-2"></i>
                    Privacy & Security
                </h3>
                <div class="space-y-3 text-sm">
                    {% if not assessment.requires_login %}
                    <div class="flex items-center">
                        <i class="fas fa-user-secret text-green-600 mr-2"></i>
                        <span class="text-gray-700">Anonymous assessment available</span>
                    </div>
                    {% endif %}
                    <div class="flex items-center">
                        <i class="fas fa-lock text-green-600 mr-2"></i>
                        <span class="text-gray-700">Your responses are confidential</span>
                    </div>
                    <div class="flex items-center">
                        <i class="fas fa-database text-green-600 mr-2"></i>
                        <span class="text-gray-700">Secure data storage</span>
                    </div>
                    <div class="flex items-center">
                        <i class="fas fa-eye-slash text-green-600 mr-2"></i>
                        <span class="text-gray-700">No personal data required</span>
                    </div>
                </div>
            </div>

            <!-- Support Resources -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">
                    <i class="fas fa-hands-helping text-purple-600 mr-2"></i>
                    Need Support?
                </h3>
                <div class="space-y-3">
                    <a href="{% url 'assessments:emergency' %}" class="block p-3 bg-red-50 hover:bg-red-100 rounded-lg transition duration-300">
                        <div class="flex items-center">
                            <i class="fas fa-exclamation-triangle text-red-600 mr-2"></i>
                            <span class="text-red-800 font-medium">Emergency Resources</span>
                        </div>
                        <p class="text-xs text-red-600 mt-1">Crisis support available 24/7</p>
                    </a>
                    <a href="{% url 'resources:list' %}" class="block p-3 bg-blue-50 hover:bg-blue-100 rounded-lg transition duration-300">
                        <div class="flex items-center">
                            <i class="fas fa-book text-blue-600 mr-2"></i>
                            <span class="text-blue-800 font-medium">Resource Library</span>
                        </div>
                        <p class="text-xs text-blue-600 mt-1">Articles and self-help tools</p>
                    </a>
                </div>
            </div>

            <!-- Assessment Info -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">
                    <i class="fas fa-info text-blue-600 mr-2"></i>
                    About {{ assessment.short_name }}
                </h3>
                <div class="space-y-3 text-sm text-gray-600">
                    {% if assessment.short_name == 'PHQ9' %}
                    <p>The PHQ-9 is a widely used screening tool for depression. It helps identify symptoms and their severity.</p>
                    <p>Used by healthcare professionals worldwide for initial assessment and monitoring treatment progress.</p>
                    {% elif assessment.short_name == 'GAD7' %}
                    <p>The GAD-7 is a validated screening tool for generalized anxiety disorder and panic disorder.</p>
                    <p>Helps measure anxiety severity and track changes over time.</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
</div>
{% endblock %}
